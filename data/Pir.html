<!doctype html>
<html lang="zh" class="no-js">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700' rel='stylesheet' type='text/css'>

	<link rel="stylesheet" href="css/reset.css"> <!-- CSS reset -->
	<link rel="stylesheet" href="css/style.css"> <!-- Resource style -->
	<link rel="stylesheet" href="style.css"> <!-- Resource style -->
	<script defer="defer">
		window.onload = function () {
            //循环执行，每隔1秒钟执行一次 1000 
			var t1 = window.setInterval(refreshTemperature, 5000);
			refreshTemperature();
            function refreshTemperature() {
                var xmlhttp;
                if (window.XMLHttpRequest) {
                    xmlhttp = new XMLHttpRequest();
                } else {
                    xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
                }
                xmlhttp.onreadystatechange = function () {
                    // var temperature = document.getElementById("temperature");
                    // var Humidity = document.getElementById("Humidity");
                    // var computeHeat = document.getElementById("computeHeat");
                    var HumenActive = document.getElementById("HumenActive");
                    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                        var obj = JSON.parse(xmlhttp.responseText);
                        var haobj = obj["HumenActive"];
                        // temperature.innerHTML = obj["temperature"];
                        // Humidity.innerHTML = obj["Humidity"];
                        // computeHeat.innerHTML = obj["computeHeat"];
                        if(haobj["status"] == true) {
                            HumenActive.innerHTML = "有人员活动";
                        }
                        else {
                            HumenActive.innerHTML = "无人员活动";
                        }
                        var str = "";
                        var strmins = "";
                        for(var i in haobj["list"]) {
                            str += "<div class='logline'>";
                            str += "<div class='datetime'>" + haobj["list"][i]["start"] + " - " + haobj["list"][i]["end"] + "</div>";
                            str += "<div class='mins'>< " + haobj["list"][i]["mins"] + " ></div>";
                            str += "</div>"
                        }
                        document.getElementById("HALog").innerHTML = str;
                    }
                };
                xmlhttp.open("GET", "getTemperature", true);
                xmlhttp.send();
            }
            // 去掉定时器的方法  
            // window.clearInterval(t1);   
        };
	</script>
	<title>Esp8266 Home Center | jjbboox</title>
</head>
<body>
	
	<main>
		<h1 class="title">人员活动监测</h1>
		<center>
			<table class="data">
				<tr class="datarow">
                    <td class="label">人员活动</td>
                    <td id="HumenActive" class="cvalue"></td>
				</tr>
				<tr class="datarow">
                    <td class="label">活动记录</td>
                    <td class="cvalue" id="HALog"></td>
				</tr>
			</table>
		</center>
		<!-- all your content here -->
	</main>
	
</body>
</html>